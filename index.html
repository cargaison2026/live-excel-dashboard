<!DOCTYPE html>
<html>
<head>
<title>Live Violation Dashboard</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>

<style>
body {
font-family: Arial;
background:#f4f6f8;
padding:20px;
}

.card {
background:white;
padding:20px;
margin:10px;
display:inline-block;
border-radius:8px;
box-shadow:0 2px 5px rgba(0,0,0,0.1);
}

canvas {
background:white;
padding:10px;
margin-top:20px;
}
</style>
</head>

<body>

<h2>Live Violation Dashboard</h2>

<div class="card">
Total Violations: <span id="total">0</span>
</div>

<div class="card">
OOS Violations: <span id="oos">0</span>
</div>

<canvas id="chart"></canvas>

<script>

const csvUrl = "https://cargaisonlogistics-my.sharepoint.com/:x:/g/personal/osama_cargosolutionexpress_com/IQB97JXf6jOtTKPv8vdrU2LYARAkFd9zTy0nMdyupdG9C9A?download=1";

Papa.parse(csvUrl, {

download: true,
header: true,

complete: function(results) {

const data = results.data.filter(row => row.Driver);

document.getElementById("total").innerText = data.length;

const oos = data.filter(row => row.OOS == "YES" || row.OOS == "Yes").length;

document.getElementById("oos").innerText = oos;

const companyCount = {};

data.forEach(row => {

const company = row.Company || "Unknown";

companyCount[company] = (companyCount[company] || 0) + 1;

});

const labels = Object.keys(companyCount);
const values = Object.values(companyCount);

new Chart(document.getElementById("chart"), {

type: "bar",

data: {
labels: labels,
datasets: [{
label: "Violations by Company",
data: values
}]
}

});

}

});

</script>

</body>
</html>
