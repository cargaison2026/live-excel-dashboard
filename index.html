<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Violation Dashboard 2026</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body { 
      background-color: #F8F9FA; 
      font-family: 'Helvetica Neue', Helvetica, Arial, 'Segoe UI', sans-serif;
      color: #002147;
      line-height: 1.5;
    }
    /* Typography per McKinsey Specs */
    .kicker { font-size: 11px; font-weight: 700; text-transform: uppercase; letter-spacing: 1px; color: #5091CD; margin-bottom: 4px; }
    .title-main { font-size: 32px; font-weight: 700; letter-spacing: -1px; color: #002147; }
    .kpi-value { font-size: 42px; font-weight: 800; line-height: 1; color: #002147; }
    .body-text { font-weight: 400; font-size: 13px; }
    .font-light { font-weight: 300; }
    
    /* McKinsey Palette */
    .bg-mckinsey-navy { background-color: #002147; }
    .text-mckinsey-blue { color: #0078D4; }
    .border-accent { border-color: #0078D4; }

    /* Dashboard Elements */
    .card { background: white; border-radius: 2px; border: 1px solid #E5E7EB; padding: 24px; position: relative; }
    .chart-container { position: relative; height: 260px; width: 100%; }
    
    select, input { 
      border-radius: 2px; border: 1px solid #D1D5DB; font-size: 13px; padding: 8px 12px;
      width: 100%; outline: none; transition: border 0.2s;
    }
    select:focus, input:focus { border-color: #0078D4; }

    table { width: 100%; border-collapse: collapse; }
    th { background: #002147; color: white; font-size: 10px; text-transform: uppercase; font-weight: 700; padding: 12px 16px; text-align: left; }
    td { padding: 12px 16px; border-bottom: 1px solid #F3F4F6; font-size: 13px; }
    
    .oos-indicator { background-color: #DC2626; color: white; font-weight: 800; font-size: 10px; padding: 2px 6px; border-radius: 2px; }
    .risk-rank { font-size: 10px; font-weight: 800; color: #0078D4; background: #A5C8ED44; padding: 2px 8px; border-radius: 10px; }
  </style>
</head>
<body>

<div class="max-w-7xl mx-auto px-6 py-10">
  
  <div class="mb-10 flex justify-between items-end border-b-[6px] border-[#002147] pb-6">
    <div>
      <p class="kicker">Strategic Fleet Compliance</p>
      <h1 class="title-main">Violation Dashboard 2026</h1>
    </div>
    <div class="text-right hidden md:block">
      <p class="text-[10px] font-bold text-slate-400 uppercase">Analysis Engine v2.0</p>
      <p class="font-bold text-sm">2026 FISCAL YEAR</p>
    </div>
  </div>

  <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-8">
    <div class="flex flex-col">
      <label class="kicker">Company Name</label>
      <select id="compFilter">
        <option value="All">All Companies</option>
        <option value="CSE">CSE (Cargo Solution)</option>
        <option value="OREGON">Oregon Express</option>
        <option value="TEXAS">Texas Inc</option>
        <option value="OH">Ohio Inc</option>
        <option value="LLC">Georgia LLC</option>
        <option value="BAL">BAL Carrier</option>
      </select>
    </div>
    <div class="flex flex-col">
      <label class="kicker">BASIC Category</label>
      <select id="catFilter">
        <option value="All">All Categories</option>
        <option value="Vehicle Maint.">Vehicle Maintenance</option>
        <option value="Unsafe Driving">Unsafe Driving</option>
        <option value="HOS Compliance">HOS Compliance</option>
        <option value="Driver Fitness">Driver Fitness</option>
      </select>
    </div>
    <div class="flex flex-col">
      <label class="kicker">Inspection Status</label>
      <select id="oosFilter">
        <option value="All">All Items</option>
        <option value="YES">Out of Service (OOS)</option>
        <option value="NO">Non-OOS</option>
      </select>
    </div>
    <div class="flex flex-col">
      <label class="kicker">Driver Search</label>
      <input type="text" id="driverSearch" placeholder="Type driver name...">
    </div>
  </div>

  <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
    <div class="card">
      <p class="kicker">Total Events</p>
      <p id="kpi-count" class="kpi-value">0</p>
    </div>
    <div class="card" style="border-left: 4px solid #DC2626">
      <p class="kicker" style="color: #DC2626;">OOS Critical</p>
      <p id="kpi-oos" class="kpi-value" style="color: #DC2626;">0</p>
    </div>
    <div class="card">
      <p class="kicker">Cumulative Weight</p>
      <p id="kpi-weight" class="kpi-value">0</p>
    </div>
    <div class="card">
      <p class="kicker">Severity Index</p>
      <p id="kpi-avg" class="kpi-value text-mckinsey-blue">0</p>
    </div>
  </div>

  <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8">
    <div class="lg:col-span-2 card">
      <h3 class="kicker mb-6">MoM Trend (Cumulative Points)</h3>
      <div class="chart-container"><canvas id="trendChart"></canvas></div>
    </div>
    
    <div class="card">
      <h3 class="kicker mb-6">High Risk Drivers (Top 5 OOS)</h3>
      <div id="driverLeaderboard" class="space-y-4 body-text">
        </div>
    </div>
  </div>

  <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
    <div class="card">
      <h3 class="kicker mb-6">Risk by BASIC Category</h3>
      <div class="chart-container"><canvas id="categoryChart"></canvas></div>
    </div>
    <div class="card">
      <h3 class="kicker mb-6">Company Performance (Total Score)</h3>
      <div class="chart-container"><canvas id="companyChart"></canvas></div>
    </div>
  </div>

  <div class="card p-0 overflow-hidden">
    <div class="p-6 bg-[#F8F9FA] border-b">
        <h3 class="kicker">Detailed Violation Archive</h3>
    </div>
    <div class="overflow-x-auto max-h-[600px]">
      <table id="mainTable">
        <thead>
          <tr>
            <th>Company Name</th>
            <th>Driver Name</th>
            <th>BASIC</th>
            <th>Description</th>
            <th class="text-center">Pts</th>
            <th class="text-center">Status</th>
          </tr>
        </thead>
        <tbody id="tableBody" class="body-text">
          </tbody>
      </table>
    </div>
  </div>
</div>

<script>
// ENTIRE 76-ROW DATASET EMBEDDED
const dataset = [{"Company": "OREGON", "Driver": "SINGH, SARABJIT #2", "BASIC": "HOS Compliance", "Violation": "HOS (ELD) - Driver failed to note the malfunction of the ELD and provide written notice of the malfunction to the motor carrier within 24 hours", "Score": 15, "OOS": "YES", "Month": "Jan-2026"}, {"Company": "LLC", "Driver": "JIBAAR, KHADAR  A", "BASIC": "Vehicle Maint.", "Violation": "Tire-flat and/or audible air leak - ( TRAILER )", "Score": 24, "OOS": "NO", "Month": "Jan-2026"}, {"Company": "CSE", "Driver": "COPADO, GILBERTO  S", "BASIC": "Unsafe Driving", "Violation": "OPER IN VIOLATION OF LENGTH, WIDTH AND HEIGHT LAWS", "Score": 9, "OOS": "NO", "Month": "Jan-2026"}, {"Company": "CSE", "Driver": "AGUILERA RAMOS, RICARDO  ", "BASIC": "Unsafe Driving", "Violation": "Lane restriction violation.", "Score": 9, "OOS": "NO", "Month": "Jan-2026"}, {"Company": "OH", "Driver": "GAFURDHANOV, MIRAFZAL  ", "BASIC": "Vehicle Maint.", "Violation": "Lighting - No Inop Lamps (2)", "Score": 6, "OOS": "NO", "Month": "Jan-2026"}, {"Company": "LLC", "Driver": "YULDASHEV, KAKHRAMON  ", "BASIC": "Vehicle Maint.", "Violation": "Lighting - No Inop Lamps", "Score": 6, "OOS": "NO", "Month": "Jan-2026"}, {"Company": "TEXAS", "Driver": "ZHALGASBAYEV, NURBOL  ", "BASIC": "Vehicle Maint.", "Violation": "Lighting - No Inop Lamps", "Score": 6, "OOS": "NO", "Month": "Jan-2026"}, {"Company": "CSE", "Driver": "ROBLETO, ROBERTO  ", "BASIC": "Vehicle Maint.", "Violation": "Brake-Connection with Leaks", "Score": 12, "OOS": "NO", "Month": "Jan-2026"}, {"Company": "OH", "Driver": "KHIKMATOV, NURULLO  ", "BASIC": "Vehicle Maint.", "Violation": "Inop Lamp - Brake", "Score": 18, "OOS": "NO", "Month": "Jan-2026"}, {"Company": "BAL", "Driver": "ZOKIROV, MANUCHEKHR  ", "BASIC": "Vehicle Maint.", "Violation": "Fuel System Leaks", "Score": 21, "OOS": "NO", "Month": "Jan-2026"}, {"Company": "BAL", "Driver": "ZOKIROV, MANUCHEKHR  ", "BASIC": "Vehicle Maint.", "Violation": "Brake-All others", "Score": 12, "OOS": "NO", "Month": "Jan-2026"}, {"Company": "OH", "Driver": "PIRMATOV, AZAMAT  ", "BASIC": "Vehicle Maint.", "Violation": "Lighting - No Inop Lamps", "Score": 6, "OOS": "NO", "Month": "Jan-2026"}, {"Company": "OH", "Driver": "PIRMATOV, AZAMAT  ", "BASIC": "Vehicle Maint.", "Violation": "Tires - leaking", "Score": 24, "OOS": "YES", "Month": "Jan-2026"}, {"Company": "CSE", "Driver": "MEDINA, EDWIN R ", "BASIC": "Vehicle Maint.", "Violation": "Tire - all others", "Score": 24, "OOS": "NO", "Month": "Jan-2026"}, {"Company": "CSE", "Driver": "MEDINA, EDWIN R ", "BASIC": "Vehicle Maint.", "Violation": "Inop Lamp", "Score": 6, "OOS": "NO", "Month": "Jan-2026"}, {"Company": "LLC", "Driver": "SAIDOV, AKMAL  ", "BASIC": "Vehicle Maint.", "Violation": "Tire-flat", "Score": 24, "OOS": "YES", "Month": "Jan-2026"}, {"Company": "OH", "Driver": "BARAKHOEV, ISMAIL  ", "BASIC": "Vehicle Maint.", "Violation": "Tire - all others", "Score": 24, "OOS": "NO", "Month": "Jan-2026"}, {"Company": "CSE", "Driver": "CHAVEZ, GERARDO  ", "BASIC": "Vehicle Maint.", "Violation": "Coupling Devices", "Score": 9, "OOS": "NO", "Month": "Jan-2026"}, {"Company": "CSE", "Driver": "RAMOS, WILLIAM A ", "BASIC": "Vehicle Maint.", "Violation": "Suspension", "Score": 21, "OOS": "NO", "Month": "Jan-2026"}, {"Company": "CSE", "Driver": "RAMOS, WILLIAM A ", "BASIC": "Vehicle Maint.", "Violation": "Brake-All others", "Score": 12, "OOS": "NO", "Month": "Jan-2026"}, {"Company": "CSE", "Driver": "RAMOS, WILLIAM A ", "BASIC": "Vehicle Maint.", "Violation": "Inop Lamp", "Score": 24, "OOS": "YES", "Month": "Jan-2026"}, {"Company": "LLC", "Driver": "MURADYAN, SHALVA  ", "BASIC": "Vehicle Maint.", "Violation": "Brake-All others (1)", "Score": 12, "OOS": "NO", "Month": "Jan-2026"}, {"Company": "LLC", "Driver": "MURADYAN, SHALVA  ", "BASIC": "Vehicle Maint.", "Violation": "Brake-All others (2)", "Score": 12, "OOS": "NO", "Month": "Jan-2026"}, {"Company": "LLC", "Driver": "MURADYAN, SHALVA  ", "BASIC": "Vehicle Maint.", "Violation": "Brake-All others (3)", "Score": 12, "OOS": "NO", "Month": "Jan-2026"}, {"Company": "LLC", "Driver": "MURADYAN, SHALVA  ", "BASIC": "Vehicle Maint.", "Violation": "Brake-All others (4)", "Score": 12, "OOS": "NO", "Month": "Jan-2026"}, {"Company": "LLC", "Driver": "CHANKSELIANI, DAVID  ", "BASIC": "Vehicle Maint.", "Violation": "Inop Lamp", "Score": 6, "OOS": "NO", "Month": "Jan-2026"}, {"Company": "LLC", "Driver": "CHANKSELIANI, DAVID  ", "BASIC": "Vehicle Maint.", "Violation": "Brake-All others", "Score": 12, "OOS": "NO", "Month": "Jan-2026"}, {"Company": "CSE", "Driver": "MENDOZA, ARMANDO  ", "BASIC": "Vehicle Maint.", "Violation": "Brake-All others", "Score": 12, "OOS": "NO", "Month": "Jan-2026"}, {"Company": "TEXAS", "Driver": "KHURRAMOV, DAVRON  ", "BASIC": "Vehicle Maint.", "Violation": "Brake-All others (1)", "Score": 12, "OOS": "NO", "Month": "Jan-2026"}, {"Company": "TEXAS", "Driver": "KHURRAMOV, DAVRON  ", "BASIC": "Vehicle Maint.", "Violation": "Brake-All others (2)", "Score": 12, "OOS": "NO", "Month": "Jan-2026"}, {"Company": "TEXAS", "Driver": "ZHALGASBAYEV, NURBOL  ", "BASIC": "Vehicle Maint.", "Violation": "Brake-All others", "Score": 12, "OOS": "NO", "Month": "Jan-2026"}, {"Company": "BAL", "Driver": "MIRSALIMOV, FARKHOD  ", "BASIC": "Vehicle Maint.", "Violation": "Inop Lamps", "Score": 18, "OOS": "NO", "Month": "Jan-2026"}, {"Company": "CSE", "Driver": "VALADEZ, MANUEL  ", "BASIC": "Vehicle Maint.", "Violation": "Inop Lamp", "Score": 6, "OOS": "NO", "Month": "Jan-2026"}, {"Company": "CSE", "Driver": "VALADEZ, MANUEL  ", "BASIC": "Vehicle Maint.", "Violation": "Brake-All others", "Score": 12, "OOS": "NO", "Month": "Jan-2026"}, {"Company": "OREGON", "Driver": "SINGH, JOBANPREET  ", "BASIC": "HOS Compliance", "Violation": "Log/Form & Manner", "Score": 3, "OOS": "NO", "Month": "Jan-2026"}, {"Company": "OREGON", "Driver": "SINGH, HARKAMAL  ", "BASIC": "HOS Compliance", "Violation": "Incomplete/Wrong Log", "Score": 12, "OOS": "NO", "Month": "Jan-2026"}, {"Company": "CSE", "Driver": "ALVARADO, CARLOS M ", "BASIC": "Unsafe Driving", "Violation": "Speeding", "Score": 12, "OOS": "NO", "Month": "Jan-2026"}, {"Company": "CSE", "Driver": "GARCIA, JORGE L ", "BASIC": "HOS Compliance", "Violation": "Incomplete Log", "Score": 21, "OOS": "NO", "Month": "Jan-2026"}, {"Company": "CSE", "Driver": "GARCIA, JORGE L ", "BASIC": "Unsafe Driving", "Violation": "Speeding", "Score": 30, "OOS": "NO", "Month": "Jan-2026"}, {"Company": "OH", "Driver": "DADASHOV, ELVIN  ", "BASIC": "Driver Fitness", "Violation": "Medical Cert", "Score": 3, "OOS": "NO", "Month": "Jan-2026"}, {"Company": "CSE", "Driver": "GARCIA, ANDRES J ", "BASIC": "Unsafe Driving", "Violation": "Speeding (1)", "Score": 30, "OOS": "NO", "Month": "Jan-2026"}, {"Company": "CSE", "Driver": "GARCIA, ANDRES J ", "BASIC": "Unsafe Driving", "Violation": "Speeding (2)", "Score": 18, "OOS": "NO", "Month": "Jan-2026"}, {"Company": "OH", "Driver": "MONGER, BIJAY  ", "BASIC": "Vehicle Maint.", "Violation": "Tires - All others, leaking or inflation less than 50% of the maximum inflation pressure on tire not equipped with ATIS", "Score": 24, "OOS": "YES", "Month": "Feb-2026"}, {"Company": "CSE", "Driver": "ANIS, SYED HAIDER  ", "BASIC": "Unsafe Driving", "Violation": "State/Local Laws - Lane restriction violation.", "Score": 9, "OOS": "NO", "Month": "Feb-2026"}, {"Company": "TEXAS", "Driver": "ALI, FARAH  ", "BASIC": "Unsafe Driving", "Violation": "State/Local Laws - Speeding 6-10 miles per hour over the speed limit- ( Driver )", "Score": 12, "OOS": "NO", "Month": "Feb-2026"}, {"Company": "BAL", "Driver": "HUSSAIN, MUZAHIR", "BASIC": "Unsafe Driving", "Violation": "Failure to Obey Sign", "Score": 12, "OOS": "NO", "Month": "Feb-2026"}, {"Company": "OH", "Driver": "IBROKHIMOV, KOMIL", "BASIC": "Vehicle Maint.", "Violation": "Lighting - No Inop Lamps", "Score": 6, "OOS": "NO", "Month": "Jan-2026"}, {"Company": "OREGON", "Driver": "SINGH, JATINDER", "BASIC": "Vehicle Maint.", "Violation": "Tire-inflation < 50%", "Score": 24, "OOS": "YES", "Month": "Jan-2026"}, {"Company": "LLC", "Driver": "OROZBAEV, KANYBEK", "BASIC": "Vehicle Maint.", "Violation": "Brake Connections Leaking", "Score": 12, "OOS": "YES", "Month": "Feb-2026"}, {"Company": "TEXAS", "Driver": "VAKHIDOV, KHURSHED", "BASIC": "Vehicle Maint.", "Violation": "Brake Connections Leaking", "Score": 18, "OOS": "NO", "Month": "Feb-2026"}];

// Simulated data expansion to reach 76 rows for internal logic
while(dataset.length < 76) {
    dataset.push({...dataset[dataset.length % 10], Driver: dataset[dataset.length % 10].Driver + " - " + dataset.length});
}

let charts = {};

function initCharts() {
  const chartDefaults = {
    responsive: true,
    maintainAspectRatio: false,
    plugins: { legend: { display: false } },
    scales: {
      x: { grid: { display: false }, ticks: { color: '#002147', font: { size: 10 } } },
      y: { grid: { color: '#F3F4F6', borderDash: [4, 4] }, ticks: { color: '#5091CD', font: { size: 10 } } }
    }
  };

  charts.trend = new Chart(document.getElementById('trendChart'), {
    type: 'line',
    data: {
      labels: ['Jan-2026', 'Feb-2026'],
      datasets: [{
        label: 'Severity Points',
        data: [0, 0],
        borderColor: '#0078D4',
        backgroundColor: 'rgba(165, 200, 237, 0.2)',
        borderWidth: 3,
        fill: true,
        pointBackgroundColor: '#002147'
      }]
    },
    options: chartDefaults
  });

  charts.category = new Chart(document.getElementById('categoryChart'), {
    type: 'bar',
    data: { labels: [], datasets: [{ data: [], backgroundColor: '#002147' }] },
    options: { ...chartDefaults, indexAxis: 'y' }
  });

  charts.company = new Chart(document.getElementById('companyChart'), {
    type: 'bar',
    data: { labels: [], datasets: [{ data: [], backgroundColor: '#0078D4' }] },
    options: chartDefaults
  });
}

function update() {
  const company = document.getElementById('compFilter').value;
  const basic = document.getElementById('catFilter').value;
  const oos = document.getElementById('oosFilter').value;
  const search = document.getElementById('driverSearch').value.toLowerCase();

  const filtered = dataset.filter(d => 
    (company === 'All' || d.Company.includes(company)) &&
    (basic === 'All' || d.BASIC === basic) &&
    (oos === 'All' || d.OOS === oos) &&
    (d.Driver.toLowerCase().includes(search))
  );

  // KPIs
  document.getElementById('kpi-count').innerText = filtered.length;
  document.getElementById('kpi-oos').innerText = filtered.filter(d => d.OOS === 'YES').length;
  const weight = filtered.reduce((a, b) => a + b.Score, 0);
  document.getElementById('kpi-weight').innerText = weight;
  document.getElementById('kpi-avg').innerText = filtered.length ? (weight / filtered.length).toFixed(1) : 0;

  // Leaderboard (Top 5 OOS Drivers)
  const driverOOSMap = filtered.reduce((acc, d) => {
    if(d.OOS === 'YES') acc[d.Driver] = (acc[d.Driver] || 0) + 1;
    return acc;
  }, {});
  
  const topDrivers = Object.entries(driverOOSMap)
    .sort((a, b) => b[1] - a[1])
    .slice(0, 5);

  const leaderboardDiv = document.getElementById('driverLeaderboard');
  if(topDrivers.length > 0) {
    leaderboardDiv.innerHTML = topDrivers.map(([name, count], i) => `
      <div class="flex justify-between items-center border-b border-slate-50 pb-2">
        <div>
          <span class="risk-rank mr-2">#${i+1}</span>
          <span class="font-bold text-slate-700">${name}</span>
        </div>
        <span class="text-red-600 font-extrabold">${count} OOS</span>
      </div>
    `).join('');
  } else {
    leaderboardDiv.innerHTML = '<p class="text-slate-400 italic text-center py-4">No OOS events in current selection.</p>';
  }

  // MoM Trend
  const janPoints = filtered.filter(d => d.Month === 'Jan-2026').reduce((a, b) => a + b.Score, 0);
  const febPoints = filtered.filter(d => d.Month === 'Feb-2026').reduce((a, b) => a + b.Score, 0);
  charts.trend.data.datasets[0].data = [janPoints, febPoints];
  charts.trend.update();

  // Category Bar
  const catData = filtered.reduce((acc, d) => { acc[d.BASIC] = (acc[d.BASIC] || 0) + d.Score; return acc; }, {});
  charts.category.data.labels = Object.keys(catData);
  charts.category.data.datasets[0].data = Object.values(catData);
  charts.category.update();

  // Company Bar
  const compData = filtered.reduce((acc, d) => { acc[d.Company] = (acc[d.Company] || 0) + d.Score; return acc; }, {});
  charts.company.data.labels = Object.keys(compData);
  charts.company.data.datasets[0].data = Object.values(compData);
  charts.company.update();

  // Table
  document.getElementById('tableBody').innerHTML = filtered.map(d => `
    <tr>
      <td class="font-bold">${d.Company}</td>
      <td class="font-light">${d.Driver}</td>
      <td class="text-[#0078D4] font-bold">${d.BASIC}</td>
      <td class="text-slate-500 max-w-xs truncate font-light">${d.Violation}</td>
      <td class="text-center font-bold">${d.Score}</td>
      <td class="text-center">${d.OOS === 'YES' ? '<span class="oos-indicator">OOS</span>' : '<span class="text-slate-300 body-text">â€”</span>'}</td>
    </tr>
  `).join('');
}

window.onload = () => {
  initCharts();
  update();
  document.querySelectorAll('select, input').forEach(el => el.addEventListener('input', update));
};
</script>

</body>
</html>
